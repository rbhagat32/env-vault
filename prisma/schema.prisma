generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id      String  @id @default(uuid())
  clerkId String  @unique @map("clerk_id")
  name    String
  email   String  @unique
  avatar  String?

  projects Project[] @relation("UserProjects")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("users")
}

model Project {
  id   String @id @default(uuid())
  name String
  slug String @unique

  ownerId String @map("owner_id")
  owner   User   @relation("UserProjects", fields: [ownerId], references: [id])

  members Json @default("[]") // [{ user1, role }, { user2, role }]

  variables Variable[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("projects")
}

model Variable {
  id    String @id @default(uuid())
  key   String
  value String

  projectId String  @map("project_id")
  project   Project @relation(fields: [projectId], references: [id])

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@unique([projectId, key])
  @@map("variables")
}

enum PermissionRole {
  READ
  WRITE
  DELETE
  ADMIN
}
